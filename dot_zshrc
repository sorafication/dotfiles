# Fig pre block. Keep at the top of this file.
export PATH="${PATH}:${HOME}/.local/bin"
eval "$(fig init zsh pre)"


# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi


# General Exports
export ZSH="$HOME/.oh-my-zsh"
export EDITOR="nvim"
export XDG_CONFIG_HOME=$HOME/.config



export http_proxy=http://meta-proxy.netrtl.com:8080
export https_proxy=http://meta-proxy.netrtl.com:8080
export no_proxy="*.netrtl.com,.netrtlsrv.com,localhost,127.0.0.1"
export VAULT_ADDR=https://vault.shared.secrets.prod.da-service.io



# Source everything else
source $HOME/.config/zsh/functions --source_only
source $HOME/.config/zsh/aliases --source_only
source $HOME/.config/zsh/zsh-vim-mode --source_only

PROMPT_EOL_MARK=''
bindkey "^[^[[C" forward-word
bindkey "^[^[[D" backward-word


# See https://github.com/ohmyzsh/ohmyzsh/wiki/Themes
ZSH_THEME="powerlevel10k/powerlevel10k"

#Plugins
plugins=(
git
zsh-autosuggestions
fzf
ssh-agent
gcloud
you-should-use
zsh-syntax-highlighting
)

# Always add SSH Keys to ssh-agent
zstyle :omz:plugins:ssh-agent agent-forwarding yes
zstyle :omz:plugins:ssh-agent lazy no
zstyle :omz:plugins:ssh-agent identities id_rsa_oki id_rsa_hosting
source $ZSH/oh-my-zsh.sh


#### NEW ZSH CONFIG #####


### Fix slowness of pastes with zsh-syntax-highlighting.zsh
pasteinit() {
  OLD_SELF_INSERT=${${(s.:.)widgets[self-insert]}[2,3]}
  zle -N self-insert url-quote-magic # I wonder if you'd need `.url-quote-magic`?
}

pastefinish() {
  zle -N self-insert $OLD_SELF_INSERT
}
zstyle :bracketed-paste-magic paste-init pasteinit
zstyle :bracketed-paste-magic paste-finish pastefinish
### Fix slowness of pastes




# To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

 echo -n "Ron Swanson: " && curl -s http://ron-swanson-quotes.herokuapp.com/v2/quotes | sed 's/.*\[//;s/\].*//;'



# Fig post block. Keep at the bottom of this file.
eval "$(fig init zsh post)"
